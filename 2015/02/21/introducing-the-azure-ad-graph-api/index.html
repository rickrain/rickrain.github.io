<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="d ago"><meta name="hour-prompt" content="hr ago"><meta name="minute-prompt" content="min ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.3.1" /><meta property="og:title" content="Introducing the Azure AD Graph API" /><meta property="og:locale" content="en" /><meta name="description" content="At the end of the last post I closed by mentioning how the Azure AD Graph API and the IsMemberOf function could be used to determine a user’s membership in Azure AD Groups. However, as you saw in the last post, the group claims feature recently added to Azure AD made that task extremely simple without needing to use the Graph API. Still, there are many application scenarios where the Graph API is very useful and so it is the purpose of this post to formally introduce you to the Azure AD Graph API and introduce some handy client libraries you can use to access the Graph API." /><meta property="og:description" content="At the end of the last post I closed by mentioning how the Azure AD Graph API and the IsMemberOf function could be used to determine a user’s membership in Azure AD Groups. However, as you saw in the last post, the group claims feature recently added to Azure AD made that task extremely simple without needing to use the Graph API. Still, there are many application scenarios where the Graph API is very useful and so it is the purpose of this post to formally introduce you to the Azure AD Graph API and introduce some handy client libraries you can use to access the Graph API." /><link rel="canonical" href="https://rickrainey.com/2015/02/21/introducing-the-azure-ad-graph-api/" /><meta property="og:url" content="https://rickrainey.com/2015/02/21/introducing-the-azure-ad-graph-api/" /><meta property="og:site_name" content="Rick Rainey" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2015-02-21T15:06:04-06:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Introducing the Azure AD Graph API" /><meta name="twitter:site" content="@rickraineytx" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-09-22T15:38:09-05:00","datePublished":"2015-02-21T15:06:04-06:00","description":"At the end of the last post I closed by mentioning how the Azure AD Graph API and the IsMemberOf function could be used to determine a user’s membership in Azure AD Groups. However, as you saw in the last post, the group claims feature recently added to Azure AD made that task extremely simple without needing to use the Graph API. Still, there are many application scenarios where the Graph API is very useful and so it is the purpose of this post to formally introduce you to the Azure AD Graph API and introduce some handy client libraries you can use to access the Graph API.","headline":"Introducing the Azure AD Graph API","mainEntityOfPage":{"@type":"WebPage","@id":"https://rickrainey.com/2015/02/21/introducing-the-azure-ad-graph-api/"},"url":"https://rickrainey.com/2015/02/21/introducing-the-azure-ad-graph-api/"}</script><title>Introducing the Azure AD Graph API | Rick Rainey</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Rick Rainey"><meta name="application-name" content="Rick Rainey"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/rick-outdoors.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Rick Rainey</a></div><div class="site-subtitle font-italic">Where I share my learnings to help others</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/rickrain" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/rickraineytx" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['rickrain','hotmail.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Introducing the Azure AD Graph API</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Introducing the Azure AD Graph API</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Rick Rainey </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sat, Feb 21, 2015, 3:06 PM -0600" >Feb 21, 2015<i class="unloaded">2015-02-21T15:06:04-06:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Wed, Sep 22, 2021, 3:38 PM -0500" >Sep 22, 2021<i class="unloaded">2021-09-22T15:38:09-05:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2870 words">15 min read</span></div></div><div class="post-content"><p>At the end of the last post I closed by mentioning how the <a href="https://msdn.microsoft.com/en-us/library/azure/hh974478.aspx">Azure AD Graph API</a> and the <a href="https://msdn.microsoft.com/en-us/library/azure/dn151601.aspx">IsMemberOf</a> function could be used to determine a user’s membership in Azure AD Groups. However, as you saw in the last post, the group claims feature recently added to Azure AD made that task extremely simple without needing to use the Graph API. Still, there are many application scenarios where the Graph API is very useful and so it is the purpose of this post to formally introduce you to the Azure AD Graph API and introduce some handy client libraries you can use to access the Graph API.</p><h2 id="introduction-to-the-azure-active-directory-graph-api">Introduction to the Azure Active Directory Graph API</h2><p>Azure Active Directory provides a Graph API for every tenant that can be used to programmatically access the directory. So, if you have an Azure Subscription then the Azure AD Graph API is already there for you to use. Using the Graph API, you can do things such as query the directory to discover users, groups, and relationships between users. You can also use the Graph API to make changes to the directory such as adding, deleting, and updating users. In other words, the Graph API gives you <a href="http://en.wikipedia.org/wiki/Create,_read,_update_and_delete">CRUD</a> capabilities when accessing the graph. And while my simple introduction is in the context of users and groups, don’t assume those as limitations for the Graph API. It is far more reaching than this and can be used to access virtually any entity in the directory.</p><p>Like many other services in Azure, the Graph API is a REST API so programming against it is easy for any web developer using any language. For .NET developers, you could use the <a href="https://www.nuget.org/packages/Microsoft.Net.Http">Microsoft Http Client Libraries</a> to construct your REST calls to the Graph API. When available, I prefer to use client libraries that take care of invoking the REST API’s for me and Microsoft provides the <a href="https://www.nuget.org/packages/Microsoft.Azure.ActiveDirectory.GraphClient">.NET Azure AD Graph Client Library</a> that does exactly that.</p><p>The Graph API endpoint for your directory will be https://graph.windows.net/[YOUR TENANT ID]. If you have a custom domain configured for your directory then you could use that in place of your tenant ID. For example, either of the following endpoints are valid for my directory with a custom domain of cloudalloc.com.</p><ul><li>https://graph.windows.net/b3ebae33-54c5-4232-9693-01c76c13ee76<li>https://graph.windows.net/cloudalloc.com</ul><p>You can find your Graph API endpoint using the Azure Management portal by clicking on the <strong>VIEW ENDPOINTS</strong> button at the bottom of the <strong>APPLICATIONS</strong> page for your directory as shown here.</p><p><img data-proofer-ignore data-src="/assets/img/introducing-the-azure-ad-graph-api-01.png" alt="Graph API Endpoints" /></p><p>This will open a window showing all the application endpoints for your directory as shown below. Note: Even if you have a custom domain configured, this screen will show your endpoints using your tenant ID. But, you can exchange the tenant ID for your custom domain when accessing these endpoints in your code as you will see me do later in this post.</p><p><img data-proofer-ignore data-src="/assets/img/introducing-the-azure-ad-graph-api-02.png" alt="Graph API Endpoints" /></p><p>At this point, we have a basic understanding of what the Graph API could be used for, where to access it, and some libraries that can be used to build applications using the Graph API. In the remainder of this post I will demonstrate using the .NET Azure AD Graph API Library and ADAL to implement some scenarios that are made possible via the graph.</p><h2 id="develop-a-client-application-for-the-azure-ad-graph-api">Develop a Client Application for the Azure AD Graph API</h2><p>For this post, I’m going to break away from the sample and scenarios of previous posts in this series and create a new application so you can see all the steps from beginning to end in one post. So, let’s get started.</p><p>My application is going to be a very simple console application. Doesn’t get any simpler than that! The application is going to access the Graph API and perform a few simple operations.</p><h3 id="register-a-new-application-in-azure-ad">Register a New Application in Azure AD</h3><p>The first step is to register an application in Azure AD. This is done in the APPLICATIONS page of your directory in the Azure Management Portal. Click on the ADD button at the bottom of the page to proceed through the new application wizard.</p><p>The first page of the wizard as shown in Figure 3 needs a name for my application and the type of application it is. For this application, even though it is a console application, I am choosing the Web Application and/or Web API type. The reason I’m doing this is because I want my application to authenticate using application credentials rather than prompting the user running the application to authenticate with his/her username and password.</p><p><img data-proofer-ignore data-src="/assets/img/introducing-the-azure-ad-graph-api-03.png" alt="Add Application" /></p><p>Since I chose the Web Application/Web API application type, the next page in the wizard needs a valid sign-in URL and application ID URI. Since this is not really a web application any values will work as long as they are valid URL’s and URI’s as shown here.</p><p><img data-proofer-ignore data-src="/assets/img/introducing-the-azure-ad-graph-api-04.png" alt="Add Application Properties" /></p><p>That completes the application registration part. Now I need to make a couple of configuration changes which I’ll do in the next section.</p><h3 id="configure-the-application-to-access-the-azure-ad-graph">Configure the Application to Access the Azure AD Graph</h3><p>The configuration changes I need to make can be done in the <strong>CONFIGURE</strong> page for the application I registered using the Azure Management Portal. Shortly I’ll be getting into the code of the application and when I do there will be two pieces of information that I’m going to need. The first is the <strong>CLIENT ID</strong> which Azure AD generated for me when the application was registered. The other is a <strong>KEY</strong> (or secret) that I need to generate for my application so it can access the graph. Both of these are shown below. Pay attention to the message in the portal when you generate your key. As soon as you save the configuration change you will be able to see the key and copy it. After that, you will never be able to see it again so be sure to copy it before leaving the page. Otherwise, you will have to re-generate a new key. Also, notice that you can create multiple keys. This is to support key rollover scenarios. For example, as your key approaches expiration you can create a new key, update and deploy your code with the new key, and then remove the old key.</p><p><img data-proofer-ignore data-src="/assets/img/introducing-the-azure-ad-graph-api-05.png" alt="Azure AD application client ID" /></p><p>A little further down in the <strong>permissions to other applications</strong> section, I am adding an <strong>Application Permission</strong> indicating this application can <strong>Read and write directory data</strong> as shown below. This will allow my application to query the directory and make changes to it such as adding new users.</p><p><img data-proofer-ignore data-src="/assets/img/introducing-the-azure-ad-graph-api-06.png" alt="Permissions to other applications" /></p><blockquote><p>NOTE: It has been my experience that changes to permissions (application or delegated as shown above) generally take about 5 minutes to take effect. So for example, let’s assume I forgot to add the application permission above, built my application, and then realized my application didn’t have the required permissions to read the graph when I ran it. It’s a simple fix to come back here and add the permission. Just be aware that there is this delay. Otherwise, you may do like I did and start applying other unnecessary changes to try and get it working. Just be patient.</p></blockquote><p>Now, with these configuration changes saved, I’m ready to transition into the coding of this application.</p><h3 id="create-a-new-console-application-using-visual-studio">Create a new Console Application using Visual Studio</h3><p>After creating my new Console Application in Visual Studio, the first thing I want to do is bring in the client libraries that I’ll be using to access the graph in my directory. Both are available as NuGet packages and are as follows:</p><ul><li><a href="https://www.nuget.org/packages/Microsoft.IdentityModel.Clients.ActiveDirectory/2.14.201151115">Active Directory Authentication Library (ADAL)</a>, v2.14.201151115<li><a href="https://www.nuget.org/packages/Microsoft.Azure.ActiveDirectory.GraphClient/2.0.5">Azure Active Directory Graph Client Library</a>, v2.05</ul><h3 id="add-configuration-settings">Add Configuration Settings</h3><p>The first thing I’m going to do is bring in some settings from Azure AD and configuration from the application I just registered in my directory. I’ll need this information for authenticating to Azure AD and accessing the graph.</p><div class="language-c# highlighter-rouge"><div class="code-header"> <span text-data=" C# "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="c1">// This is the URL the application will authenticate at.</span>
<span class="k">const</span> <span class="kt">string</span> <span class="n">authString</span> <span class="p">=</span> <span class="s">"https://login.windows.net/cloudalloc.com"</span><span class="p">;</span>
 
<span class="c1">// These are the credentials the application will present during authentication</span>
<span class="c1">// and were retrieved from the Azure Management Portal.</span>
<span class="c1">// *** Don't even try to use these - they have been deleted.</span>
<span class="k">const</span> <span class="kt">string</span> <span class="n">clientID</span> <span class="p">=</span> <span class="s">"07e33f8a-166f-4d79-a46d-f96dccf08b76"</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">string</span> <span class="n">clientSecret</span> <span class="p">=</span> <span class="s">"s9e6moGcFsRPP0rENcniLIi3q1hgmpGCUJUrpSIenvY="</span><span class="p">;</span>
 
<span class="c1">// The Azure AD Graph API is the "resource" we're going to request access to.</span>
<span class="k">const</span> <span class="kt">string</span> <span class="n">resAzureGraphAPI</span> <span class="p">=</span> <span class="s">"https://graph.windows.net"</span><span class="p">;</span>
 
<span class="c1">// The Azure AD Graph API for my directory is available at this URL.</span>
<span class="k">const</span> <span class="kt">string</span> <span class="n">serviceRootURL</span> <span class="p">=</span> <span class="s">"https://graph.windows.net/cloudalloc.com"</span><span class="p">;</span>
</pre></table></code></div></div><p>The settings in this code may look familiar. For example, the authString, resAzureGraphAPI and the serviceRootURL are simply from the App Endpoints dialog in Figure 2 above. The clientID and clientSecret were generated when registering the application as referenced in Figure 5 above and it is these two settings that will be used to generate a <strong>ClientCredential</strong> for authenticating to Azure AD later in this post. And while I’m talking about keys understand that it is not a best practice to store keys like this in code. I am showing it here out of convenience for this blog post. I suggest you be mindful of <a href="http://www.asp.net/identity/overview/features-api/best-practices-for-deploying-passwords-and-other-sensitive-data-to-aspnet-and-azure">best practices for deploying passwords and other sensitive data to ASP.NET and Azure Websites</a> for your own applications.</p><h3 id="instantiate-activedirectoryclient-from-the-azure-ad-graph-client-library">Instantiate ActiveDirectoryClient from the Azure AD Graph Client Library</h3><p>The Azure Active Directory Graph Client Library provides a class called the <strong>ActiveDirectoryClient</strong> that is used to access all the properties available to you in the graph, such as users, groups, contacts, the applications you have registered, and much more. As shown below, there are several properties hanging off of it to work with the various entities in your directory. The list of methods is brief and you will notice the <strong>IsMemberOfAsync</strong> that I talked about in previous posts as an alternative way to determine if a user is in a particular group.</p><p><img data-proofer-ignore data-src="/assets/img/introducing-the-azure-ad-graph-api-07.png" alt="ActiveDirectoryClient class" /></p><p>So, let’s begin this journey by looking at what it takes to instantiate an instance of this class. The constructor is shown below and I’m sure you will agree this it has a signature that is not your typical method signature. In particular, notice the 2nd parameter that I’ve highlighted. What you are required to provide here is a method that will acquire a token from Azure AD. Simple, right? Actually it is but at first glance this is a little intimidating.</p><div class="language-c# highlighter-rouge"><div class="code-header"> <span text-data=" C# "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="k">public</span> <span class="nf">ActiveDirectoryClient</span><span class="p">(</span><span class="n">Uri</span> <span class="n">serviceRoot</span><span class="p">,</span>
     <span class="n">Func</span><span class="p">&lt;</span><span class="n">Task</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;&gt;</span> <span class="n">accessTokenGetter</span><span class="p">,</span>
     <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">CustomTypeMapping</span><span class="p">&gt;</span> <span class="n">customTypeMappings</span> <span class="p">=</span> <span class="k">null</span><span class="p">);</span>
</pre></table></code></div></div><p>Here is how I am instantiating an instance of <strong>ActiveDirectoryClient</strong> in my application.</p><div class="language-c# highlighter-rouge"><div class="code-header"> <span text-data=" C# "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c1">// Instantiate an instance of ActiveDirectoryClient.</span>
<span class="n">Uri</span> <span class="n">serviceRoot</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Uri</span><span class="p">(</span><span class="n">serviceRootURL</span><span class="p">);</span>
<span class="n">ActiveDirectoryClient</span> <span class="n">adClient</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">ActiveDirectoryClient</span><span class="p">(</span>
    <span class="n">serviceRoot</span><span class="p">,</span>
    <span class="k">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="k">await</span> <span class="nf">GetAppTokenAsync</span><span class="p">());</span>
</pre></table></code></div></div><p>The first parameter is pretty straight forward where serviceRoot is just the Graph API endpoint for my directory.</p><p>The second parameter is using a <a href="https://msdn.microsoft.com/en-us/library/bb397687.aspx">lamda expression</a> to wire up the function delegate to another method in my class called <strong>GetAppTokenAsync</strong> which I’ll get to shortly.</p><p>I am intentionally leaving out the 3rd parameter as it is beyond the scope of what I want to do in this post and as you can see from the method signature, this is ok; it will just be initialized to null.</p><p>The <strong>GetAppTokenAsync</strong> method is in my code and is tasked to do whatever is necessary to get an access token from Azure AD. This is where the Azure Active Directory Authentication Library (ADAL) comes into the picture. As you can see, it really is simple. I’m creating an authentication context for my directory, creating a credential to use to authenticate with, authenticating with Azure AD and getting an access token, and then returning the token which is just a long cryptic string.</p><div class="language-c# highlighter-rouge"><div class="code-header"> <span text-data=" C# "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="k">private</span> <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="nf">GetAppTokenAsync</span><span class="p">()</span>
<span class="p">{</span>
    <span class="c1">// Instantiate an AuthenticationContext for my directory (see authString above).</span>
    <span class="n">AuthenticationContext</span> <span class="n">authenticationContext</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">AuthenticationContext</span><span class="p">(</span><span class="n">authString</span><span class="p">,</span> <span class="k">false</span><span class="p">);</span>
             
    <span class="c1">// Create a ClientCredential that will be used for authentication.</span>
    <span class="c1">// This is where the Client ID and Key/Secret from the Azure Management Portal is used.</span>
    <span class="n">ClientCredential</span> <span class="n">clientCred</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">ClientCredential</span><span class="p">(</span><span class="n">clientID</span><span class="p">,</span> <span class="n">clientSecret</span><span class="p">);</span>
 
    <span class="c1">// Acquire an access token from Azure AD to access the Azure AD Graph (the resource)</span>
    <span class="c1">// using the Client ID and Key/Secret as credentials.</span>
    <span class="n">AuthenticationResult</span> <span class="n">authenticationResult</span> <span class="p">=</span> <span class="k">await</span> <span class="n">authenticationContext</span><span class="p">.</span><span class="nf">AcquireTokenAsync</span><span class="p">(</span><span class="n">resAzureGraphAPI</span><span class="p">,</span> <span class="n">clientCred</span><span class="p">);</span>
 
    <span class="c1">// Return the access token.</span>
    <span class="k">return</span> <span class="n">authenticationResult</span><span class="p">.</span><span class="n">AccessToken</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Now, for my simple application, since I’m using the Client ID and Key/Secret to create a credential for authenticating and acquiring an access token from Azure AD, I will not be prompted to authenticate as was the case in earlier posts in this series. If I wanted to access the graph using the identity of the user running my application, then I would have configured the application with a <strong>Delegated Permission</strong> to access the directory instead of an <strong>Application Permission</strong> as I showed earlier. In doing so, I would also use a different overloaded version of the <strong>AcquireTokenAsync</strong> method to perform the authentication and retrieve the access token.</p><p>The point I want to be clear on here is that what I’m showing you is just one of many ways to acquire an access token from Azure AD. As an exercise, I encourage you to take a look at the many overloaded <strong>AcquireTokenAsync</strong> methods to get an idea of what is possible.</p><p>Now that I’m able to connect to the graph I will show how we you perform a few operations on the graph.</p><h3 id="lookup-a-user-by-their-user-principal-name-upn">Lookup a User by their User Principal Name (UPN)</h3><p>I’ll start with a simple query of the directory. In this series I’ve used a fictitious user named John Doe to demonstrate various concepts. Below is how you could retrieve the User object for John Doe using his user principal name (UPN).</p><div class="language-c# highlighter-rouge"><div class="code-header"> <span text-data=" C# "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="c1">// Look up a user in the directory by their UPN.</span>
<span class="kt">var</span> <span class="n">upn</span> <span class="p">=</span> <span class="s">"johndoe@cloudalloc.com"</span><span class="p">;</span>
<span class="kt">var</span> <span class="n">userLookupTask</span> <span class="p">=</span> <span class="n">adClient</span><span class="p">.</span><span class="n">Users</span><span class="p">.</span><span class="nf">Where</span><span class="p">(</span>
    <span class="n">user</span> <span class="p">=&gt;</span> <span class="n">user</span><span class="p">.</span><span class="n">UserPrincipalName</span><span class="p">.</span><span class="nf">Equals</span><span class="p">(</span>
        <span class="n">upn</span><span class="p">,</span> <span class="n">StringComparison</span><span class="p">.</span><span class="n">CurrentCultureIgnoreCase</span><span class="p">)).</span><span class="nf">ExecuteSingleAsync</span><span class="p">();</span>
 
<span class="n">User</span> <span class="n">userJohnDoe</span> <span class="p">=</span> <span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="k">await</span> <span class="n">userLookupTask</span><span class="p">;</span>
 
<span class="c1">// Show John Doe's Name</span>
<span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">userJohnDoe</span><span class="p">.</span><span class="n">DisplayName</span><span class="p">);</span>
</pre></table></code></div></div><h3 id="add-a-new-user-to-the-directory">Add a New User to the Directory</h3><p>To add a new user to the directory you need to instantiate an instance of the User class and set some required properties as shown in the code below. There are many more properties that you can set for the user, but these are the minimum requirements for adding a user. The <strong>AddUserAsync</strong> method will write the user object into the directory.</p><div class="language-c# highlighter-rouge"><div class="code-header"> <span text-data=" C# "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="c1">// Create a new user object.</span>
<span class="kt">var</span> <span class="n">newUser</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">User</span><span class="p">()</span>
<span class="p">{</span>
    <span class="c1">// Required settings</span>
    <span class="n">DisplayName</span> <span class="p">=</span> <span class="s">"Jay Hamlin"</span><span class="p">,</span>
    <span class="n">UserPrincipalName</span> <span class="p">=</span> <span class="s">"jayhamlin@cloudalloc.com"</span><span class="p">,</span>
    <span class="n">PasswordProfile</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">PasswordProfile</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">Password</span> <span class="p">=</span> <span class="s">"H@ckMeNow!"</span><span class="p">,</span>
        <span class="n">ForceChangePasswordNextLogin</span> <span class="p">=</span> <span class="k">false</span>
    <span class="p">},</span>
    <span class="n">MailNickname</span> <span class="p">=</span> <span class="s">"JayHamlin"</span><span class="p">,</span>
    <span class="n">AccountEnabled</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span>
 
    <span class="c1">// Some (not all) optional settings</span>
    <span class="n">GivenName</span> <span class="p">=</span> <span class="s">"Jay"</span><span class="p">,</span>
    <span class="n">Surname</span> <span class="p">=</span> <span class="s">"Hamlin"</span><span class="p">,</span>
    <span class="n">JobTitle</span> <span class="p">=</span> <span class="s">"Programmer"</span><span class="p">,</span>
    <span class="n">Department</span> <span class="p">=</span> <span class="s">"Development"</span><span class="p">,</span>
    <span class="n">City</span> <span class="p">=</span> <span class="s">"Dallas"</span><span class="p">,</span>
    <span class="n">State</span> <span class="p">=</span> <span class="s">"TX"</span><span class="p">,</span>
    <span class="n">Mobile</span> <span class="p">=</span> <span class="s">"214-123-1234"</span><span class="p">,</span>
<span class="p">};</span>
 
<span class="c1">// Add the user to the directory</span>
<span class="n">adClient</span><span class="p">.</span><span class="n">Users</span><span class="p">.</span><span class="nf">AddUserAsync</span><span class="p">(</span><span class="n">newUser</span><span class="p">).</span><span class="nf">Wait</span><span class="p">();</span>
</pre></table></code></div></div><h3 id="assign-a-users-manager">Assign a User’s Manager</h3><p>The Manager property is defined in the base class <strong>DirectoryObject</strong> that <strong>User</strong> derives from. So, when setting the Manager property you need to cast the user back to a <strong>DirectoryObject</strong> as I’ve shown here. Also, notice that when I update the graph I do so by calling UpdateAsync on the user who is being assigned as the manager and not the user whose Manager property is being set.</p><div class="language-c# highlighter-rouge"><div class="code-header"> <span text-data=" C# "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="c1">// Make John Doe this user's Manager</span>
<span class="n">newUser</span><span class="p">.</span><span class="n">Manager</span> <span class="p">=</span> <span class="p">(</span><span class="n">DirectoryObject</span><span class="p">)</span><span class="n">userJohnDoe</span><span class="p">;</span>
<span class="n">userJohnDoe</span><span class="p">.</span><span class="nf">UpdateAsync</span><span class="p">().</span><span class="nf">Wait</span><span class="p">();</span>
</pre></table></code></div></div><h3 id="retrieve-a-list-of-direct-reports-for-a-user">Retrieve a List of Direct Reports for a User</h3><p>In the previous step I made Jay Hamlin’s manager John Doe. You can see all of John Doe’s direct reports as shown in the following code.</p><div class="language-c# highlighter-rouge"><div class="code-header"> <span text-data=" C# "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="c1">// Get a list of John Doe's Direct Reports</span>
<span class="n">IUserFetcher</span> <span class="n">userFetcher</span> <span class="p">=</span> <span class="p">(</span><span class="n">IUserFetcher</span><span class="p">)</span><span class="n">userJohnDoe</span><span class="p">;</span>
<span class="kt">var</span> <span class="n">directReportsTask</span> <span class="p">=</span> <span class="n">userFetcher</span><span class="p">.</span><span class="n">DirectReports</span><span class="p">.</span><span class="nf">ExecuteAsync</span><span class="p">();</span>
<span class="kt">var</span> <span class="n">directReports</span> <span class="p">=</span> <span class="k">await</span> <span class="n">directReportsTask</span><span class="p">;</span>
<span class="k">do</span>
<span class="p">{</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="n">IDirectoryObject</span> <span class="n">dirObj</span> <span class="k">in</span> <span class="n">directReports</span><span class="p">.</span><span class="n">CurrentPage</span><span class="p">.</span><span class="nf">ToList</span><span class="p">())</span>
    <span class="p">{</span>
        <span class="kt">var</span> <span class="n">directReport</span> <span class="p">=</span> <span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="n">dirObj</span><span class="p">;</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">directReport</span><span class="p">.</span><span class="n">DisplayName</span><span class="p">);</span>
    <span class="p">}</span>
 
<span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">directReports</span><span class="p">.</span><span class="n">MorePagesAvailable</span><span class="p">);</span>
</pre></table></code></div></div><h2 id="summary">Summary</h2><p>In this post I introduced you to the Azure AD Graph API and laid the groundwork for how you can leverage the graph in your own applications. I showed how to add and configure an application in the Azure Management Portal to use the graph and then I introduced you to the Azure AD Graph Client Library. Next, I provided sample code to connect to the graph and perform a few basic operations.</p><p>I barely scratched the surface of possibilities that the Azure AD Graph API presents. The Azure AD team has some excellent samples on GitHub that show many more scenarios for using the Graph API and the Graph Client Library in console and web applications. In addition to the samples, the Azure AD Graph Team has some nice blogs for you to learn more about the Graph API and the Azure AD Graph Client Library. Links to these resources are below in the References section. So, I encourage you to go explore the graph of possibilities.</p><h2 id="references">References</h2><ul><li><a href="http://blogs.msdn.com/b/aadgraphteam/">Azure Active Directory Graph Team Blog</a><li><a href="https://github.com/AzureADSamples/ConsoleApp-GraphAPI-DotNet">Console Application Graph API Example</a><li><a href="https://github.com/AzureADSamples/WebApp-GraphAPI-DotNet">Web Application Graph API Example</a><li><a href="https://msdn.microsoft.com/en-us/library/azure/jj126255.aspx">Common Queries</a></ul><div id="disqus_thread"></div><script> /** * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS. * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/ /* var disqus_config = function () { this.page.url = ""; // Replace PAGE_URL with your page's canonical URL variable this.page.identifier = "/2015/02/21/introducing-the-azure-ad-graph-api/"; // Replace PAGE_IDENTIFIER with your page's unique identifier variable }; */ (function() { // DON'T EDIT BELOW THIS LINE var d = document, s = d.createElement('script'); s.src = 'https://rickrainey.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div><div class="post-tail-wrapper text-muted"><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Introducing the Azure AD Graph API - Rick Rainey&url=https://rickrainey.com/2015/02/21/introducing-the-azure-ad-graph-api/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Introducing the Azure AD Graph API - Rick Rainey&u=https://rickrainey.com/2015/02/21/introducing-the-azure-ad-graph-api/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Introducing the Azure AD Graph API - Rick Rainey&url=https://rickrainey.com/2015/02/21/introducing-the-azure-ad-graph-api/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/ubuntu-dev-setup/">Developer Laptop Setup on Ubuntu</a><li><a href="/posts/ckad-tips/">CKAD Exam Tips</a><li><a href="/2013/04/16/polyglot-persistence-in-windows-azure/">Polyglot Persistence in Windows Azure</a><li><a href="/2013/05/22/implementing-polyglot-persistence-part-1/">Implementing Polyglot Persistence – Part 1</a><li><a href="/2013/05/27/setting-up-a-neo4j-server-running-on-ubuntu-in-windows-azure/">Setting up a Neo4j Server running on Ubuntu in Windows Azure</a></ul></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/ubuntu-dev-setup/"><div class="card-body"> <span class="timeago small" >Dec 6, 2021<i class="unloaded">2021-12-06T09:00:00-06:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Developer Laptop Setup on Ubuntu</h3><div class="text-muted small"><p> This blog is really a crutch for me to remember how I like to setup my Ubuntu desktop for development work. I recently got a new laptop and had to go through the process again of setting it up the ...</p></div></div></a></div><div class="card"> <a href="/posts/ckad-tips/"><div class="card-body"> <span class="timeago small" >Oct 12, 2021<i class="unloaded">2021-10-12T10:00:00-05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>CKAD Exam Tips</h3><div class="text-muted small"><p> I recently took and passed the CKAD Exam and now the proud owner of the CKAD Certification issued by The Linux Foundation. Like so many others who have accomplished this, I decided to share some ti...</p></div></div></a></div><div class="card"> <a href="/2016/06/22/add-a-custom-device-to-the-azure-iot-suite-remote-monitoring-solution/"><div class="card-body"> <span class="timeago small" >Jun 22, 2016<i class="unloaded">2016-06-22T16:06:04-05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Add a custom device to the Azure IoT Suite Remote Monitoring solution</h3><div class="text-muted small"><p> Today, Azure IoT Suite provides two end-to-end IoT solutions; Predictive Maintenance and Remote Monitoring. These solutions can be deployed into your Azure subscription and running in just a few mi...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/2015/02/19/azure-redis-cache/" class="btn btn-outline-primary" prompt="Older"><p>Azure Redis Cache</p></a> <a href="/2015/03/27/extending-azure-ad-using-the-graph-api/" class="btn btn-outline-primary" prompt="Newer"><p>Extending Azure AD using the Graph API</p></a></div><div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = 'https://rickrainey.com/2015/02/21/introducing-the-azure-ad-graph-api/'; this.page.identifier = '/2015/02/21/introducing-the-azure-ad-graph-api/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver(function (entries) { if(entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://rickrainey.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] }); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { /* Disqus hasn't been loaded */ if (typeof DISQUS === "undefined") { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } const modeToggle = document.querySelector(".mode-toggle"); if (modeToggle !== null) { modeToggle.addEventListener('click', reloadDisqus); window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', reloadDisqus); } </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/rickraineytx">Rick Rainey</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
